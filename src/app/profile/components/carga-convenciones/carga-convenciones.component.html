<div class="d-flex flex-column">

  <div class="d-flex align-items-center justify-content-center selector-container">

    <div class="d-flex flex-column align-items-center"  *ngFor="let select of selectorBar; let i = index">

      <div class="selector d-flex align-items-center justify-content-around flex-column"
         [ngClass]="{'active': i+1==selected, 'check-selector': i+1<selected }">

        <img [src]="select.imgUrl" alt="imagen selector" class="selector-img" *ngIf="i+1>=selected">
        <img src="/assets/check-icon.svg" alt="imagen check" class="selector-img-check" *ngIf="i+1<selected">

        <p class="selector-text" *ngIf="i+1>=selected">
          {{select.title}}
        </p>

      </div>

      <p class="text-select">
        Paso {{i+1}}
      </p>

    </div>


  </div>

  <div class="d-flex flex-column" *ngIf="selected == 1">

    <p class="title-pasos">
      I. Carga de Informacion
    </p>

    <label for="input-data" class="label-input-data d-flex justify-content-around align-items-center" >
      Carga de informacion
      <img src="/assets/upload-icon.svg" alt="upload">
    </label>
    <input type="file" id="input-data" (change)="saveFile($event)"
           accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">

    <div class="d-flex flex-column" *ngIf="isData">
      <p class="title-pasos">
        II. Vista predeterminada de la información
      </p>

      <div class="table-diry-data-container">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th *ngFor="let header of dirtyData.columns">
                {{header}}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let header of dirtyData.data; let i = index">
              <td>
                {{i+1}}
              </td>
              <td *ngFor="let col of dirtyData.data[i]">
                {{col}}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <button class="btn btn-subir-paso1" (click)="subirInfo()">
        Subir informacion
      </button>
    </div>

  </div>

  <div class="d-flex flex-column" *ngIf="selected >= 2" >

    <div class="d-flex flex-column">
      <p class="title-pasos" *ngIf="!limpieza_flag">
        Limpieza de documento
      </p>

      <p class="title-pasos" *ngIf="limpieza_flag">
        Resultado previo a la limpieza
      </p>

      <div class="table-diry-data-container">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th *ngFor="let header of dirtyData.columns">
                {{header}}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let header of dirtyData.data; let i = index">
              <td>
                {{i+1}}
              </td>
              <td *ngFor="let col of dirtyData.data[i]">
                {{col}}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="title-pasos" *ngIf="limpieza_flag">
        Resultado limpieza
      </p>

      <div class="table-diry-data-container" *ngIf="limpieza_flag">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th *ngFor="let header of cleanData.columns">
                {{header}}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let header of cleanData.data; let i = index">
              <td>
                {{i+1}}
              </td>
              <td *ngFor="let col of cleanData.data[i]">
                {{col}}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <button class="btn btn-subir-paso1" (click)="limpieza()" *ngIf="!limpieza_flag">
        Realizar Limpieza
      </button>

      <div class="d-flex justify-content-end" *ngIf="limpieza_flag">

        <button class="btn btn-cancelar" (click)="resetAll()">
          Cancelar
        </button>

        <button class="btn btn-subir-paso1" (click)="save()">
          Guardar
        </button>

      </div>
    </div>

  </div>

  <div class="modal fade" id="modalExito" tabindex="-1" aria-labelledby="modalExitoLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl-custom">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body d-flex flex-column align-items-center">
          <img src="/assets/check-orange-icon.svg" alt="correcto" class="check-icon">
          <p class="modal-text-2">
            La información ha sido guardada con éxito
          </p>
          <div class="d-flex justify-content-center mt-5 w-100">
            <button type="button" class="btn btn-modal" data-bs-dismiss="modal" (click)="resetAll()">Continuar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <button class="btn-hiden" #toggleModal data-bs-toggle="modal" data-bs-target="#modalExito"></button>

  <div class="modal fade" id="modalError" tabindex="-1" aria-labelledby="modalErrorLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl-custom">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body d-flex flex-column align-items-center">
          <p class="modal-text-2">
            Error en el formato del archivo, por favor vuelva a intentarlo
          </p>
          <div class="d-flex justify-content-center mt-5 w-100">
            <button type="button" class="btn btn-modal" data-bs-dismiss="modal">Continuar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <button class="btn-hiden" #toggleModalError data-bs-toggle="modal" data-bs-target="#modalError"></button>

  <app-loading [textLoading]="textLoading" *ngIf="isLoading"></app-loading>

</div>
